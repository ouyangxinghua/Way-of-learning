<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <div class="wrapper">

    </div>
    <script>
    //   wrapper 是挂载点 mount到根节点上
    const wrapper = document.querySelector('.wrapper');
    // String -> DOM 一次性的把str 放到DOM
    const createDOMFromString = (domstring) => {
      // DOM 比htmlString 好的地方在于, js 操作
      const div = document.createElement('div');
      div.innerHTML = domstring;
      return div;
    }
    class LikeButton{
        // 之前的dom template  必备的方法
        constructor () {
          this.state = {
            isLiked: false,
            text: ''
          }
        }
        changeLikeText(){
          // 太多的DOM了
          // const likeText = this.el.querySelector('.like-text');
          // this.state.isLiked = !this.state.isLiked;
          // likeText.innerHTML = this.state.isLiked ? '取消' : '点赞';
          // console.log(this.el)
          this.setState({
            isLiked: !this.state.isLiked
          })
        }
        render(){
            this.el =  createDOMFromString(`
              <button id="like-btn">
                <span class="like-text">${this.state.isLiked ? '取消' : '点赞'}</span>
              </button>
            `)
            this.el.addEventListener('click', this.changeLikeText.bind(this), false);
            return this.el;
        }
        setState(state) {
            // 将状态更新
            // MVVM 的VM 环节 this.state  View 视图的实时对应
            const oldEl = this.el;
            this.state = state;
            this.el = this.render()
            // DOM 更新
            if (this.onStateChange){
              this.onStateChange(oldEl, this.el)
            }
        }
    }
    const likeButton1 = new LikeButton();
    wrapper.appendChild(likeButton1.render());
    likeButton1.onStateChange = (oldEl, newEl) => {
        wrapper.insertBefore(newEl, oldEl);
        wrapper.removeChild(oldEl);
    }
    const likeButton2 = new LikeButton();
    wrapper.appendChild(likeButton2.render());
    likeButton2.onStateChange = (oldEl, newEl) => {
        wrapper.insertBefore(newEl, oldEl);
        wrapper.removeChild(oldEl);
    }

    </script>
    <!-- <div class="wrapper">
        <button class="like-btn">
            <span class="like-text">
               点赞
            </span> 
        <tton>
    </div> -->
    <!-- <script>
      const button=document.querySelector('.like-btn')
      const buttonText=button.querySelector('.like-text')
      isLiked=false
      button.addEventListener('click',()=>{
           isLiked=!isLiked
           if(isLiked){
            buttonText.innerHTML='取消点赞'
           }else{
            buttonText.innerHTML='点赞'
           }
      })
    </script> -->
</body>
<html>
