<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.0.2/css/swiper.min.css">
    <script src="https://cdn.bootcss.com/jquery/3.1.0/jquery.min.js"></script>
    <link href="https://cdn.bootcss.com/weui/1.1.3/style/weui.min.css" rel="stylesheet">
    <script src="https://cdn.bootcss.com/jquery-weui/1.2.1/js/jquery-weui.min.js"></script>
    <script src="http://g.tbcdn.cn/mtb/lib-flexible/0.3.4/??flexible_css.js,flexible.js"></script>
    <link rel="stylesheet" href="style.css">
    <title>猫眼电影</title>
    <style>
        #play {
            stroke: white;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: rgba(0, 0, 0, 0.6);
        }

        #center {
            fill: white;
        }

        #play2 {
            stroke: white;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: rgba(0, 0, 0, 0.6);
        }

        #center2 {
            fill: white;
        }

        #icon {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        #icon2 {
            position: absolute;
            left: 2.2rem;
            bottom: 0.3rem;
        }
    </style>
</head>

<body>
    <div class="page">
        <header class="nav">
            <i class="arrow-left"></i>
            <span>影⽚详情</span>
        </header>
        <section class="movie-header">
            <div class="movie">
                <div class="movie-background"></div>
                <div class="movie-filter"></div>
                <div class="movie-container">
                    <!-- pic -->
                    <div class="movie-cover">
                        <svg id="icon" width="44" height="44">
                            <!-- 定义 反复使用 -->
                            <defs>
                                <!-- 模板 -->
                                <symbol id="play">
                                    <ellipse cx="23" cy="23" rx="20" ry="20"></ellipse>
                                    <polygon id="center" points="
                                                      20 16
                                                      30 24
                                                      20 32
                                                      " />
                                </symbol>
                            </defs>
                            <use href="#play" width="44" height="44"></use>
                        </svg>
                        <a href="#" class="link">
                            <img class='img' src="./images/header-bg.jpg" alt="" id="moviePic">
                        </a>
                    </div>
                    <!-- detail -->
                    <div class="movie-content">
                        <div class="movie-name">
                            <span></span>
                        </div>
                        <div class="movie-ename">
                            <span></span>
                        </div>
                        <!-- star -->
                        <div class="movie-score">
                            <div class="released-score">
                                <div class="rating" id="rating">
                                    <span class="rating-score"></span>
                                </div>
                                <div class="score-num">
                                    (<span></span>⼈评分)
                                </div>
                            </div>
                        </div>
                        <div class="movie-detail">
                            <p class="movie-type"></p>
                            <p class="address-time">
                                <span class="address">zg</span>
                                /
                                <span class="time">111</span>
                                分钟
                            </p>
                            <p class="date"></p>
                        </div>
                    </div>
                </div>
                <div class="operating flex">
                    <div class="movie-watch flex1" id="movie-watch">
                        <img src="./images/heart.png" alt="">
                        <span>想看</span>
                    </div>
                    <div class="movie-mark flex1">
                        <img src="./images/star2.png" alt="">
                        <span>评分</span>
                    </div>
                </div>
            </div>
        </section>
        <!-- section2 -->
        <section class="section-seperate section-expander">
            <div class="text-expander">
                <div class="text-expander__content close">
                    <p></p>
                </div>
                <div class="text-expander__button">
                    <i class="icon-chevron__down"></i>
                </div>
            </div>
        </section>
        <!-- section3 -->
        <section class="movie-actor">
            <div class="title">
                <span class="text">演职人员</span>
            </div>
            <div class="movie-actor__lists">
                <ul class="items">
                    <!-- <li class="item">
                        <img src="./images/fenfen.jpg" alt="">
                        <p class="name"></p>
                        <p class="work"></p>
                    </li> -->
                </ul>
            </div>
        </section>
        <section class="Boxoffice">
            <p class="title">票房</p>
            <div class="content">
                <div class="message">
                    <p class="number one"></p>
                    <p class="text">昨日票房排行</p>
                </div>
                <div class="message">
                    <p class="number two"></p>
                    <p class="text">首周票房(万)</p>
                </div>
                <div class="message">
                    <p class="number three"></p>
                    <p class="text">累计票房(万)</p>
                </div>
            </div>
        </section>
        <!-- section4 -->
        <section class="footer_buy">
            <span>特惠购票</span>
        </section>
        <!-- section5 -->
        <section class="movie-photo">
            <div class="title">
                <span class="left">
                    视频和剧照
                </span>
                <span class="right">
                    255 >
                </span>
            </div>
            <ul class="movie-photo_lists">
                <svg id="icon2" width="44" height="44">
                    <!-- 定义 反复使用 -->
                    <defs>
                        <!-- 模板 -->
                        <symbol id="pla2">
                            <ellipse cx="23" cy="23" rx="20" ry="20"></ellipse>
                            <polygon id="center2" points="
                                                      20 16
                                                      30 24
                                                      20 32
                                                      " />
                        </symbol>
                    </defs>
                    <use href="#play" width="44" height="44"></use>
                </svg>
            </ul>
        </section>
        <!-- section6 -->
        <section class="section-seperate section-expander section6">
            <p class="section-til pos_r">讨论
                <span class="join-comment">参与讨论</span>
            </p>
            <ul class="movie-comment">
                <li class="comment-item">
                    <div class="comment-item__sort">
                        <span>全部</span>
                    </div>
                </li>
                <li class="comment-item">
                    <div class="comment-item__sort">
                        <span>好评</span><span class="comment-item__num one"></span>
                    </div>
                </li>
                <li class="comment-item">
                    <div class="comment-item__sort">
                        <span>差评</span><span class="comment-item__num two"></span>
                    </div>
                </li>
                <li class="comment-item">
                    <div class="comment-item__sort">
                        <span>点映</span><span class="comment-item__num three"></span>
                    </div>
                </li>
                <li class="comment-item">
                    <div class="comment-item__sort">
                        <span>购票</span><span class="comment-item__num four"></span>
                    </div>
                </li>
                <li class="comment-item">
                    <div class="comment-item__sort">
                        <span>认证作者</span><span class="comment-item__num five"></span>
                    </div>
                </li>
                <li class="comment-item">
                    <div class="comment-item__sort">
                        <span>同城</span><span class="comment-item__num six"></span>
                    </div>
                </li>
            </ul>
        </section>
        <!-- section7 -->
        <section class="section-seperate section-expander section7">
            <p class="section7-title">精选</p>
            <div class="section7-main">
            </div>
        </section>
        <!-- section8 -->
        <section class="section-seperate section-expander section8">
            <div class="comment-num">
                <p class="content">
                    查看全部 <span>56748</span> 条讨论 >
                </p>
            </div>
        </section>
        <!-- toast -->
        <div id="toast">
            <div class="weui-mask_transparent"></div>
            <div class="weui-toast">
                <i class="weui-icon-success-no-circle weui-icon_toast"></i>
                <p class="weui-toast__content">已标记为想看</p>
            </div>
        </div>
    </div>
    <script>
        (function () {
            $.ajax({
                url: 'https://www.easy-mock.com/mock/5ca49624ea0dc52bf3b67ff2/jiangtingwen/jiangtingwen1',
                type: 'get',
                success: function (res) {
                    console.log(res)
                    // $('#moviePic').attr('src', res.data.moviePic)
                    $('.movie-content .movie-name span').html(res.data.name)
                    $('.movie-content .movie-ename span').html(res.data.nameEnglish)
                    star(res.data.star)
                    $('.rating-score').html(res.data.grade)
                    $('.score-num span').html(res.data.people)
                    $('.movie-type').html(res.data.type)
                    $('.address-time .address').html(res.data.where)
                    $('.address-time .time').html(res.data.time)
                    $('.movie-detail .date').html(res.data.date)
                    $('.text-expander__content p').html(res.data.desc)
                    for (let i of res.data.person) {
                        $('.movie-actor__lists .items').append(`<li class="item"><img src="${i.avatal}" alt="">
                        <p class="name">${i.name}</p>
                        <p class="work">${i.sort}</p></li>`)
                    }
                    $('.Boxoffice .one').html(res.data.booking.ranking)
                    $('.Boxoffice .two').html(res.data.booking.bookingWeek)
                    $('.Boxoffice .three').html(res.data.booking.bookingTotal)
                    $('.comment-item .one').html(res.data.commentNum.good)
                    $('.comment-item .two').html(res.data.commentNum.bad)
                    $('.comment-item .three').html(res.data.commentNum.dy)
                    $('.comment-item .four').html(res.data.commentNum.bought)
                    $('.comment-item .five').html(res.data.commentNum.author)
                    $('.comment-item .six').html(res.data.commentNum.sameCity)
                    moviepic(res.data.pictures)
                    comment(res.data.comment)
                    $('.section7-main .section7-main__item:last-child .section7-content').css('border-bottom', 'none')
                    // $('.movie-actor__lists .name').html(res.data.person[0].name)
                    // $('.movie-actor__lists .work').html(res.data.person[0].sort)
                }
            })
            function star(e) {
                let num = Math.floor(e)
                if (e > num) {
                    $('#rating').prepend('<img class="img" src="./images/star-h.png">')
                }
                for (let i = 0; i < num; i++) {
                    $('#rating').prepend('<img class="img" src="./images/star.png">')
                }
            }
            function comment(e) {
                for (let m of e) {
                    $('.section7-main').append(`<div class="section7-main__item">
                    <div class="user-pic">
                        <img src="${m.avatal}" alt="">
                    </div>
                    <div class="section7-content">
                        <div class="message">
                            <span class="name">${m.nickName}</span>
                            <img class="vip" src="${m.lever}" alt="">
                            <img class="icongou" src="./images/购.png" alt="">
                            <img id="click" class="icondian" src="./images/三个点.png" alt="">
                            <p class="grade">给这部电影打了<span>${m.grade}</span>分</p>
                        </div>
                        <div class="text">
                            <p>${m.detail}</p>
                        </div>
                        <div class="footer">
                            <span class="date">${m.date}</span>
                            <div class="like">
                                <img src="./images/赞.png" alt="">
                                <span>${m.like}</span>
                            </div>
                            <div class="comment">
                                <img src="./images/消息 (1).png" alt="">
                                <span>${m.reply}</span>
                            </div>
                        </div>
                    </div>
                    <div class="section7-share section-click">
                    <span>分享</span>
                    <span>举报</span>
                </div>
                </div>`)
                }
            }
            function moviepic(e) {
                for (let n of e)
                    $('.movie-photo_lists').append(`<li class="list">
                        <img src="${n}" alt="">
                    </li>`)
            }
            $('#movie-watch').click(function () {
                if ($(this).hasClass('active')) {
                    $('#movie-watch').removeClass('active')
                    $('#movie-watch img').attr('src', './images/heart.png')
                    $('#toast .weui-toast__content').html('已取消想看')
                } else {
                    $('#movie-watch').addClass('active')
                    $('#movie-watch img').attr('src', './images/heart1.png')
                    $('#toast .weui-toast__content').html('已标记为想看')
                }
                $('#toast').css('display', 'block')
                setTimeout(() => {
                    $('#toast').css('display', 'none')
                }, 1000)
            })
            $('.text-expander__button').click(function () {
                // $('icon-chevron__down').removeClass('up')
                if ($('.icon-chevron__down').hasClass('up')) {
                    setTimeout(() => {
                        $('.text-expander__content').css("display", "-webkit-box");
                    }, 500)
                    $('.icon-chevron__down').removeClass('up')
                } else {
                    $('.icon-chevron__down').addClass('up')
                    $('.text-expander__content').css("display", "block");
                }
            })
        })()
    </script>
</body>

</html>